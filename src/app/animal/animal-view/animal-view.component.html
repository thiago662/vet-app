<ul class="nav align-items-center bg-white border-bottom">
  <li class="nav-item p-3 text-center">
    <a [routerLink]="['/animals']">Animais</a> / {{ animal?.id }}
  </li>
</ul>

<!-- {{ animal | json }} -->

<div class="row m-0">
  <div class="col-md-8">
    <div class="card m-1 mt-3">
      <div class="row">
        <div class="col-md-2 text-center">
          <span class="fa-stack fa-lg fs-1">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa-solid fa-user fa-stack-1x fa-inverse"></i>
          </span>
        </div>
        <div class="col-md-9">
          <strong>Id:</strong> {{ animal?.id }}<br>
          <strong>Nome:</strong> {{ animal?.name }}<br>
          <!-- <strong>Email:</strong> {{ animal?.email }}<br> -->
          <!-- <strong>CPF:</strong> {{ animal?.person_id }}<br> -->
          <!-- <strong>Telefone:</strong> {{ animal?.phone_number }}<br> -->
          <!-- <strong>Celular:</strong> {{ animal?.cell_phone_number }}<br> -->
          <!-- <strong>Cep:</strong> {{ animal?.zip_code }}<br> -->
          <!-- <strong>Estado:</strong> {{ animal?.state }}<br> -->
          <!-- <strong>Cidade:</strong> {{ animal?.city }}<br> -->
          <!-- <strong>Bairro:</strong> {{ animal?.neighborhood }}<br> -->
          <!-- <strong>Rua:</strong> {{ animal?.street }}<br> -->
          <!-- <strong>Numero:</strong> {{ animal?.house_number }}<br> -->
          <!-- <strong>Referencia:</strong> {{ animal?.address_reference }}<br> -->
          <!-- <strong>Idade:</strong> {{ animal?.birth_date }}<br> -->
          <!-- <strong>Status:</strong> {{ animal?.active }}<br> -->
        </div>
        <div class="col-md-1">
          <button type="button" class="btn btn-primary btn-sm rounded-circle" (click)="openUpdateAnimalModal()" ngbTooltip="Editar animal"><i class="fa-solid fa-pen"></i></button>
          <button type="button" class="btn btn-outline-danger btn-sm rounded-circle" (click)="openDeleteAnimalModal(animal)" ngbTooltip="Excluir animal"><i class="fa-solid fa-trash"></i></button>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card m-1 mt-3">
      <div class="list-group list-group-flush">
        <div class="card-header">
          Donos
        </div>
        <div *ngFor="let owner of animal?.owners" type="button" [routerLink]="['/owners/' + owner?.id]" class="list-group-item">
          <strong>Id:</strong> {{ owner?.id }}<br>
          <strong>Nome:</strong> {{ owner?.name }}<br>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- {{ animal?.interections | json }} -->

<div class="row m-0">
  <div class="col-md-8">
    <div class="card m-1 mt-3">
      <div class="list-group list-group-flush">
        <div class="card-header">
          Historico
        </div>
        <div *ngFor="let interection of animal?.interections" class="list-group-item">
          <!-- {{ interection | json }} -->
          <div class="row">
            <div class="col-md-6">
              <h3>{{ interection?.message?.title }}</h3>
              <p>{{ interection?.message?.message }}</p>
            </div>
            <div class="col-md-6">
              <button type="button" class="btn btn-primary btn-sm rounded-circle" (click)="print(interection?.message?.message)" ngbTooltip="Editar animal"><i class="fa-solid fa-print"></i></button>
              <button type="button" class="btn btn-primary btn-sm rounded-circle" (click)="openCreateMessageModal(interection?.message?.id)" ngbTooltip="Editar animal"><i class="fa-solid fa-pen"></i></button>
              <button type="button" class="btn btn-outline-danger btn-sm rounded-circle" (click)="openDeleteMessageModal(interection?.message)" ngbTooltip="Excluir animal"><i class="fa-solid fa-trash"></i></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card m-1 mt-3">
      <div class="list-group list-group-flush">
        <div class="card-header">
          Ações
        </div>
        <div class="list-group-item" type="button" (click)="openCreateMessageModal()">
          Mensagem
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #contentUpdateAnimal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Criar animais</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <form [formGroup]="animalForm" (ngSubmit)="onSubmitToUpdateAnimal()">
    <div class="modal-body">
      <div class="mb-3">
        <label class="form-label" for="name">Nome</label>
        <input type="text" class="form-control" id="name" formControlName="name" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="species">Especie</label>
        <input type="text" class="form-control" id="species" formControlName="species" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="breed">Raça</label>
        <input type="text" class="form-control" id="breed" formControlName="breed" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="birth_date">Data de nascimento</label>
        <input type="date" class="form-control" id="birth_date" formControlName="birth_date" required>
      </div>

      <div class="row mb-3" formArrayName="owners">
        <label class="form-label" for="birth_date">Data de nascimento</label>
        <div class="col-10">
          <div class="row" *ngFor="let ownerForm of ownerForms.controls; let i = index" [formGroupName]="i">
            <div class="col-10">
              <select class="form-select" aria-label="Default select example" formControlName="owner_id">
                <option *ngFor="let owner of owners" value="{{ owner.id }}">{{ owner.name }}</option>
              </select>
            </div>
            <div class="col-2">
              <button type="button" class="btn btn-danger" ngbTooltip="Excluir dono" (click)="removeOwner(i)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="col-2">
          <button type="button" class="btn btn-primary" ngbTooltip="Adicionar dono" (click)="addOwner()">
            <i class="fas fa-plus"></i>
          </button>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label" for="active">Status</label>
        <div class="mb-3 form-check form-switch">
          <label class="form-label" for="active">{{ animalForm.controls.active.value ? 'Ativo' : 'Inativo' }}</label>
          <input type="checkbox" class="form-check-input" id="active" role="switch" formControlName="active">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Cancelar</button>
      <button type="submit" class="btn btn-primary" (click)="modal.close('Save click')" [disabled]="!animalForm.valid">Salvar</button>
    </div>
  </form>
</ng-template>

<ng-template #contentDeleteAnimal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Exclusão de animal</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <p>Deseja mesmo excluir esse animal?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Não</button>
    <button type="button" class="btn btn-primary" (click)="modal.close('Save click')">Sim</button>
  </div>
</ng-template>

<ng-template #contentCreateMessage let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Criar mensagem</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <form [formGroup]="messageForm" (ngSubmit)="onSubmitToCreateMessage(messageForm.value.id ?? null)">
    <div class="modal-body">
      <div class="mb-3">
        <label class="form-label" for="title">title</label>
        <input type="text" class="form-control" id="title" formControlName="title" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="message">message</label>
        <input type="text" class="form-control" id="message" formControlName="message">
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Cancelar</button>
      <button type="submit" class="btn btn-primary" (click)="modal.close('Save click')" [disabled]="!messageForm.valid">Salvar</button>
    </div>
  </form>
</ng-template>

<ng-template #contentDeleteMessage let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Exclusão de mensagem</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <p>Deseja mesmo excluir esse mensagem?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Não</button>
    <button type="button" class="btn btn-primary" (click)="modal.close('Save click')">Sim</button>
  </div>
</ng-template>
